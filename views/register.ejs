<!DOCTYPE html>
<html>


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="/css/register.min.css" type=text/css rel=stylesheet>

    <title>注册</title>

    <style>
        .province ul,
        .city ul {
            background: #fff;
        }
        .province ul,
        .city ul {
            width: 100%;
            margin: auto;
            border-bottom: 1px solid #eee;
        }
        ul,
        li {
            padding: 0;
            list-style: none;
        }
        #header1 {
            position: fixed;
            z-index: 999;
            top: 0;
            left: 0;
            width: 100%;
            height: 45px;
            line-height: 45px;
            background-color: #52e453;
            background-image: -webkit-gradient(linear, 0 0, 0 100%, color-stop(0, #52e453), color-stop(0.05, #52e453), color-stop(1, #52e453));
            background-image: -moz-linear-gradient(top, #3199e8, #3199e8 5%, #3199e8);
            background-image: -o-linear-gradient(top, #3199e8, #3199e8 5%, #3199e8);
            padding: 0;
            color: #eee;
            font-size: 20px;
            text-align: center;
        }
        .back {
            float: left;
            height: 28px;
            line-height: 28px;
            color: #fff;
        }
        .back icon {
            display: block;
            height: 25px;
            width: 25px;
            background-size: 75%;
            background-position: 5px 10px;
        }
        .header-info {
            height: 46px;
            line-height: 46px;
            text-align: center;
            color: #fff;
            font-size: 16px;
        }
        .header-title {
            height: 46px;
            line-height: 46px;
            text-align: center;
            color: #fff;
            font-size: 17px;
        }
        .province,
        .city {
            position: absolute;
            top: 45px;
            left: 0;
            width: 100%;
            background-color: #eee;
        }
        .province ul,
        .city ul {
            width: 100%;
            margin: auto;
            border-bottom: 1px solid #eee;
        }
        .province ul li,
        .city ul li {
            height: 45px;
            line-height: 45px;
            border-bottom: 1px solid #eee;
        }
        .province ul,
        .city ul {
            background: #fff;
        }
        .province ul:last-child,
        .city ul:last-child {
            border: none;
        }
        .province .selected-li {
            border: none;
        }
        .province .select-province {
            margin-top: 20px;
        }
        .province ul li,
        .city ul li {
            width: 92%;
            margin: auto;
        }
        .selected {
            float: right;
            color: #999;
            font-size: 12px;
            line-height: 50px;
        }
    </style>
</head>

<body>
    <div class="fade_box" id="fadeBox"></div>

    <section>
        <!--头部-->
        <div class="header">
            <a class="close" href="/">
                <img src="/img/nav_back.png">
            </a>
            <span>注册</span>
        </div>
        <!--登录框-->
        <div class="login-box">
            <div class="items">
                <div class="icon">
                    手机
                </div>
                <div class="input-box">
                    <input id="phone" class="deal" type="number" placeholder="手机(必填)">
                </div>


            </div>
            <div class="items">
                <div class="icon">
                    密码
                </div>
                <div class="input-box">
                    <input id="password" type="password" placeholder="密码(必填)">
                </div>
            </div>
            <div class="items">
                <div class="icon">
                    密码
                </div>
                <div class="input-box">
                    <input id="password_re" type="password" placeholder="确认密码">
                </div>
            </div>
            <div class="items">
                <div class="icon">
                    姓名
                </div>
                <div class="input-box">
                    <input id="stu_name" type="text" placeholder="姓名(必填)">
                </div>


            </div>

            <div class="items">
                <div class="icon">
                    姓别
                </div>
                <div class="input-box">
                    <select id="gender">

                        <option value="男">男</option>
                        <option value="女">女</option>
                    </select>
                </div>


            </div>
            <div class="items">
                <div class="icon">
                    地区
                </div>
                <div onclick="object.changeArea()" class="input-box" style="line-height:40px">
                    <input id='area' type="text" readonly='true' class="deal" placeholder="选择地区">
                </div>


            </div>
            <div class="items">
                <div class="icon">
                    身份证
                </div>
                <div class="input-box">
                    <input id='id_card' type="number" class="deal" placeholder="身份证(选填)">
                </div>


            </div>


        </div>
        <div class="submit">
            <button id="register" onclick="fn.register()">注册</button>
        </div>
    </section>
    <!--选择地区-->
    <section style="display:none">
        <div id="header1" style="">
            <div class="back" style="height: 100%;" onclick="object.closeAreatBox()">
                <icon>
                    <img src="http://2i.vt2020.com/chat/images/nav_back.png" style="width:28px;height:28px;margin-top: 10px;
margin-right: 5px;" />
                </icon>
            </div>
            <div onclick="object.closeAreatBox()" id="title" class="header-title" style="margin-left: 5px;">选择地区</div>

        </div>

        <div class="province">
            <ul class="selected-province">
                <li class="selected-li"><span id="selected-province"></span><span class="selected">已选地区</span>
                </li>
            </ul>
            <ul class="select-province">

            </ul>


        </div>

    </section>
    <!--城市-->
    <section style="display:none">
        <div id="header1" style="">
            <div class="back" style="height: 100%;" onclick="object.closeProvincetBox()">
                <icon>
                    <img src="http://2i.vt2020.com/chat/images/nav_back.png" style="width:28px;height:28px;margin-top: 10px;
margin-right: 5px;" />
                </icon>
            </div>
            <div onclick="object.closeAreatBox()" id="title" class="header-title" style="margin-left: 5px;">选择地区</div>

        </div>

        <div class="city">
            <ul class="selected-city">

            </ul>
        </div>
    </section>
    <script src="/js/jquery.min.js"></script>
    <script>
        var province = ["广东", "福建", "湖南", "湖北", "河南", "河北", "甘肃", "北京", "上海", "重庆", "安徽", "广西", "贵州", "海南", "黑龙江", "香港", "江苏", "江西", "吉林", "辽宁", "澳门", "内蒙古", "宁夏", "青海", "山东", "山西", "陕西", "四川", "台湾", "天津", "新疆", "西藏", "云南", "浙江", "海外"];
        var city = [
            ["广州", "深圳", "潮州", "澄海", "东莞", "佛山", "河源", "惠州", "江门", "揭阳", "开平", "茂名", "梅州", "清远", "汕头", "汕尾", "韶关", "顺德", "阳江", "英德", "云浮", "增城", "湛江", "肇庆", "中山", "珠海"],
            ["福州", "泉州", "福安", "龙岩", "南平", "宁德", "莆田", "三明", "邵武", "石狮", "永安", "武夷山", "厦门", "漳州"],
            ["长沙", "常德", "郴州", "衡阳", "怀化", "吉首", "娄底", "邵阳", "湘潭", "益阳", "岳阳", "永州", "张家界", "株洲"],
            ["武汉", "恩施", "鄂州", "黄冈", "黄石", "荆门", "潜江", "十堰", "随州", "武穴", "仙桃", "咸宁", "襄阳", "襄樊", "孝感", "宜昌"],
            ["郑州", "安阳", "鹤壁", "潢川", "焦作", "济源", "开封", "漯河", "洛阳", "南阳", "平顶山", "濮阳", "三门峡", "商丘", "新乡", "信阳", "许昌", "周口", "驻马店"],
            ["石家庄", "保定", "北戴河", "沧州", "承德", "丰润", "邯郸", "衡水", "廊坊", "南戴河", "秦皇岛", "唐山", "新城", "邢台", "张家口"],
            ["兰州", "白银", "定西", "敦煌", "甘南", "金昌", "酒泉", "临夏", "平凉", "天水", "武都", "武威", "西峰", "张掖"],
            ["北京"],
            ["上海"],
            ["重庆"],
            ["合肥", "安庆", "蚌埠", "亳州", "巢湖", "滁州", "阜阳", "贵池", "淮北", "淮化", "淮南", "黄山", "九华山", "六安", "马鞍山", "宿州", "铜陵", "屯溪", "芜湖", "宣城"],
            ["南宁", "百色", "北海", "桂林", "防城港", "河池", "贺州", "柳州", "钦州", "梧州", "玉林"],
            ["贵阳", "安顺", "毕节", "都匀", "凯里", "六盘水", "铜仁", "兴义", "玉屏", "遵义"],
            ["海口", "三亚", "文昌", "琼海", "五指山", "屯昌", "陵水", "乐东", "东方", "儋州", "临高", "澄迈", "定安", "琼中"],
            ["哈尔滨", "北安", "大庆", "大兴安岭", "鹤岗", "黑河", "佳木斯", "鸡西", "牡丹江", "齐齐哈尔", "七台河", "双鸭山", "绥化", "伊春"],
            ["香港", "九龙", "新界"],
            ["南京", "常熟", "海门", "淮安", "江都", "江阴", "昆山", "连云港", "南通", "启东", "沭阳", "宿迁", "苏州", "太仓", "泰州", "同里", "无锡", "徐州", "盐城", "扬州", "宜兴", "仪征", "张家港", "镇江", "周庄"],
            ["南昌", "抚州", "赣州", "吉安", "景德镇", "井冈山", "九江", "庐山", "萍乡", "上饶", "新余", "宜春", "鹰潭"],
            ["长春", "白城", "白山", "珲春", "辽源", "梅河", "吉林", "四平", "松原", "通化", "延吉"],
            ["沈阳", "鞍山", "本溪", "朝阳", "大连", "丹东", "抚顺", "阜新", "葫芦岛", "锦州", "辽阳", "盘锦", "铁岭", "营口"],
            ["澳门"],
            ["呼和浩特", "阿拉善盟", "包头", "赤峰", "东胜", "海拉尔", "集宁", "临河", "通辽", "乌海", "乌兰浩特", "锡林浩特"],
            ["银川", "固源", "石嘴山", "吴忠"],
            ["西宁", "德令哈", "格尔木", "共和", "海东", "海晏", "玛沁", "同仁", "玉树"],
            ["济南", "滨州", "兖州", "德州", "东营", "菏泽", "济宁", "莱芜", "聊城", "临沂", "蓬莱", "青岛", "曲阜", "日照", "泰安", "潍坊", "威海", "烟台", "枣庄", "淄博"],
            ["太原", "长治", "大同", "候马", "晋城", "离石", "临汾", "宁武", "朔州", "忻州", "阳泉", "榆次", "运城"],
            ["西安", "安康", "宝鸡", "汉中", "渭南", "商州", "绥德", "铜川", "咸阳", "延安", "榆林"],
            ["成都", "巴中", "达川", "德阳", "都江堰", "峨眉山", "涪陵", "广安", "广元", "九寨沟", "康定", "乐山", "泸州", "马尔康", "绵阳", "眉山", "南充", "内江", "攀枝花", "遂宁", "汶川", "西昌", "雅安", "宜宾", "自贡", "资阳"],
            ["台北", "基隆", "台南", "台中", "高雄", "屏东", "南投", "云林", "新竹", "彰化", "苗栗", "嘉义", "花莲", "桃园", "宜兰", "台东", "金门", "马祖", "澎湖"],
            ["天津"],
            ["乌鲁木齐", "阿克苏", "阿勒泰", "阿图什", "博乐", "昌吉", "东山", "哈密", "和田", "喀什", "克拉玛依", "库车", "库尔勒", "奎屯", "石河子", "塔城", "吐鲁番", "伊宁"],
            ["拉萨", "阿里", "昌都", "林芝", "那曲", "日喀则", "山南"],
            ["昆明", "大理", "保山", "楚雄", "东川", "个旧", "景洪", "开远", "临沧", "丽江", "六库", "潞西", "曲靖", "思茅", "文山", "西双版纳", "玉溪", "中甸", "昭通"],
            ["杭州", "安吉", "慈溪", "定海", "奉化", "海盐", "黄岩", "湖州", "嘉兴", "金华", "临安", "临海", "丽水", "宁波", "瓯海", "平湖", "千岛湖", "衢州", "江山", "瑞安", "绍兴", "嵊州", "台州", "温岭", "温州", "余姚", "舟山"],
            ["欧洲", "北美", "南美", "亚洲", "非洲", "大洋洲"],
        ];
    </script>
    <script>
        (function($, window, document, undefined) {
            //http://203.195.150.220:8080/api/register.action?user_name=byy&phone=14789945242&password=byy&province=%E6%B9%96%E5%8D%97&city=%E9%95%BF%E6%B2%99&cid=156156665616
            var fn = new Object();
            fn.postData = new Object();
            //


            fn.register = function() {
                if (!fn.isEmpty()) {
                    return;
                }


                fn.loading('数据提交中..');

                fn.postUrl = 'http://' + location.host + '/api/register.action?user_name=' + fn.postData.user_name + '&phone=' + fn.postData.phone + '&password=' + fn.postData.password + '&province=' + fn.postData.province + '&city=' + fn.postData.city + '&cid=' + fn.postData.cid;
                $.ajax({
                    url: fn.postUrl,
                    data: [],
                    contentType: "application/x-www-form-urlencoded; charset=utf-8",
                    dataType: 'json',
                    type: 'get',
                    success: function(data) {

                        /* alert(JSON.stringify(data));*/
                        if (data.result) {

                            setCookie('nickname', fn.postData.phone, 7);
                            setCookie('password', fn.postData.password, 7);
                            fn.loadingClose('注册成功');
                            fn.fadeBox('注册成功！');
                            location.href = '/page/commodity.action';

                        } else {

                            fn.loadingClose('重新注册');
                            fn.fadeBox(data.feedback);


                        }
                    },
                    error: function(res, erro) {

                        fn.loadingClose('重新注册');
                        fn.fadeBox('网络出错！');
                    },
                });



            }
            fn.isEmpty = function() {
                fn.postData.phone = $('#phone').val();
                fn.postData.password = $('#password').val();
                fn.postData.password_re = $('#password_re').val();
                fn.postData.user_name = $('#stu_name').val();
                fn.postData.gender = $('#gender').val();
                fn.postData.subject = $('#subject').val();
                fn.postData.cid = $('#id_card').val();

                if (fn.postData.phone == "") {
                    fn.fadeBox('请填写手机号');
                    $('#phone').focus();
                    return false;

                }
                if (!(/^1[3|4|5|8|7][0-9]\d{4,8}$/.test(fn.postData.phone))) {
                    fn.fadeBox("手机号码格式不正确!");
                    $('#phone').focus();
                    return false;
                }
                if (fn.postData.password == "") {
                    fn.fadeBox('请输入密码');
                    $('#password').focus();
                    return false;

                }
                if (fn.postData.password_re == "") {
                    fn.fadeBox('请再次确认密码');
                    $('#password_re').focus();
                    return false;

                }
                if (fn.postData.password_re != fn.postData.password) {
                    fn.fadeBox('您两次输入的密码不一致');
                    $('#password_re').focus();
                    return false;

                }

                if (fn.postData.stu_name == "") {
                    fn.fadeBox('请填写您的姓名');
                    $('#stu_name').focus();
                    return false;

                }
                if (fn.postData.id_card == "") {
                    fn.fadeBox('请填写您的身份证');
                    $('#id_card').focus();
                    return false;

                }
                if ($('#area').val().length == 0) {
                    fn.fadeBox('请选择地区');

                    return false;

                }
                return true;

            }

            fn.loading = function(text) {
                $('#register').addClass('button-loading');
                $('#register').text(text);
                $('#register').attr('disabled', 'disabled');
                $('body').append('<div id="loading"><img src="http://211.149.201.5/img/load.gif">' + text + '</div>');
            }
            fn.loadingText = function(text) {
                $('#loading').text(text);
                $('#register').text(text);
            }
            fn.loadingClose = function(text) {
                $('#loading').remove();
                $('#register').removeClass('button-loading');
                $('#register').text(text);
                $('#register').removeAttr('disabled');
            }
            fn.fadeBox = function(text) {

                $('#fadeBox').fadeIn();
                $('#fadeBox').text(text);
                var t = setTimeout("$('#fadeBox').fadeOut()", 1500);
            }
            if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {
                define(function() {
                    return fn;
                });
            } else
            if (typeof module !== 'undefined' && module.exports) {
                module.exports = fn.attach;
                module.exports.fn = fn;
            } else {
                window.fn = fn;
            }

        })(window.jQuery, window, document);

        window.object = {

            openEditBox: function() {
                $('html,body').css('background', '#fff');
                $('section').eq(1).show().siblings().hide();


            },
            openAreatBox: function() {
                $('section').hide();
                $('section').eq(1).show();

                for (var i = 0; i < province.length; i++) {
                    var li = ' <li class="select-li" onclick="object.selectProvince(' + i + ',\'' + province[i] + '\')">' + province[i] + '</li>';
                    $('.select-province').append(li);
                }

            },
            closeAreatBox: function() {

                $('section').eq(0).show().siblings().hide();

            },
            closeProvincetBox: function() {

                $('section').eq(1).show().siblings().hide();

            },



            changeArea: function() {


                object.openAreatBox();


            },

            selectProvince: function(index, province) {

                $('section').eq(1).hide();
                $('section').eq(2).show();
                $('.selected-city').empty();
                for (var i = 0; i < city[index].length; i++) {
                    var li = '<li class="selected-li" onclick="object.selectCity(\'' + city[index][i] + '\',\'' + province + '\')">' + city[index][i] + '</li>';
                    $('.selected-city').append(li);
                }
            },
            selectCity: function(city, province) {

                $('#area').val(province + city);
                $('section').hide();
                $('section').eq(0).show();
                $('#selected-province').text(province);
                fn.postData.province = province;
                fn.postData.city = city;

            }




        }

        function setCookie(c_name, value, expiredays) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + expiredays);
            document.cookie = c_name + "=" + escape(value) + ((expiredays == null) ? "" : ";expires=" + exdate.toGMTString());
        }

        function getCookie(c_name) {

            if (document.cookie.length > 0) {
                c_start = document.cookie.indexOf(c_name + "=");
                if (c_start != -1) {
                    c_start = c_start + c_name.length + 1;
                    c_end = document.cookie.indexOf(";", c_start);
                    if (c_end == -1) c_end = document.cookie.length;


                    return unescape(document.cookie.substring(c_start, c_end));
                }
            }

            return "";
        }

        function clearCookie() {
            var keys = document.cookie.match(/[^ =;]+(?=\=)/g);
            if (keys) {
                for (var i = keys.length; i--;)
                    document.cookie = keys[i] + '=0;expires=' + new Date(0).toUTCString()
            }
        }
    </script>

</body>

</html>